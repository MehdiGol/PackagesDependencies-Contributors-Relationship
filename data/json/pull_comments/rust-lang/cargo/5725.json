[{"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405030496", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405030496", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405030496, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTAzMDQ5Ng==", "user": {"login": "rust-highfive", "id": 7378925, "node_id": "MDQ6VXNlcjczNzg5MjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/7378925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rust-highfive", "html_url": "https://github.com/rust-highfive", "followers_url": "https://api.github.com/users/rust-highfive/followers", "following_url": "https://api.github.com/users/rust-highfive/following{/other_user}", "gists_url": "https://api.github.com/users/rust-highfive/gists{/gist_id}", "starred_url": "https://api.github.com/users/rust-highfive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rust-highfive/subscriptions", "organizations_url": "https://api.github.com/users/rust-highfive/orgs", "repos_url": "https://api.github.com/users/rust-highfive/repos", "events_url": "https://api.github.com/users/rust-highfive/events{/privacy}", "received_events_url": "https://api.github.com/users/rust-highfive/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-14T15:28:20Z", "updated_at": "2018-07-14T15:28:20Z", "author_association": "NONE", "body": "r? @alexcrichton\n\n(rust_highfive has picked a reviewer for you, use r? to override)"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405259284", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405259284", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405259284, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTI1OTI4NA==", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars1.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T14:07:18Z", "updated_at": "2018-07-16T14:07:18Z", "author_association": "MEMBER", "body": "For the most part all generation of \"what we're building\" happens [around here](https://github.com/rust-lang/cargo/blob/06721dd6b6f2df025af2b6d1881df380516dd970/src/cargo/ops/cargo_compile.rs#L504-L624), and @ehuss maybe you know off-hand where a fix like this would go?"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405277792", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405277792", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405277792, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTI3Nzc5Mg==", "user": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars0.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T15:02:28Z", "updated_at": "2018-07-16T15:02:28Z", "author_association": "CONTRIBUTOR", "body": "Generally it does not honor the `tested` flag when you pass explicit filters (except for `--tests` and `--examples`).  At the bottom where it filters out the `proposals`, it could skip a target if `mode == ::Test && !t.tested()`.  I imagine it should probably be consistent for other commands (bench && benched(), doc && documented(), etc.).   \r\n\r\nI'm trying to think if that would be surprising to anyone.  It does seem a little odd to ask for a target that is disabled.  It seems unlikely that anyone is relying on that?\r\n\r\nAdding a `--no-doc` flag would also be an option."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405296499", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405296499", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405296499, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTI5NjQ5OQ==", "user": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T15:58:34Z", "updated_at": "2018-07-16T15:58:34Z", "author_association": "MEMBER", "body": "Okay, I've updated with I believe the right patch but opted not to add tests for each individual case (seemed excessive). I can do so if requested though."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405379415", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405379415", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405379415, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM3OTQxNQ==", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars1.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T20:56:49Z", "updated_at": "2018-07-16T20:56:59Z", "author_association": "MEMBER", "body": "Hm looks like a number of tests are still failing?"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405393715", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405393715", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405393715, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM5MzcxNQ==", "user": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T21:54:24Z", "updated_at": "2018-07-16T21:54:24Z", "author_association": "MEMBER", "body": "From an initial look it seems that we no longer build the binaries (e.g., `src/main.rs`) when running `cargo bench --bench bench` or similar. I'm not sure that we can afford such a change... I'm going to try and go through all the tests though just to check."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405402712", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405402712", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405402712, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQwMjcxMg==", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars1.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-16T22:37:15Z", "updated_at": "2018-07-16T22:37:15Z", "author_association": "MEMBER", "body": "Ah yes indeed! We'll want to be sure to preserve that behavior :)"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/405429295", "html_url": "https://github.com/rust-lang/cargo/pull/5725#issuecomment-405429295", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5725", "id": 405429295, "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQyOTI5NQ==", "user": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "created_at": "2018-07-17T01:23:26Z", "updated_at": "2018-07-17T01:23:26Z", "author_association": "MEMBER", "body": "Okay, I am... not confident that this is correct, but it does pass tests (AFAICT). Two points of concern:\r\n - I was unable to witness `CompileMode::Bench` in this code:\r\n   - This means that independent of whether we're running `cargo test` or `cargo bench` we'll compile lib/bins with --test if either test or bench is not disabled.\r\n   - Unfortunate but seems like there's nothing we can do.\r\n - Code is not straightforward and is as such rather intricate/poorly understood.\r\n\r\nHowever: it seems to work and pass tests, so it seems \"good enough\"."}]