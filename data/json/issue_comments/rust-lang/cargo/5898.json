[{"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413388718", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413388718", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413388718, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM4ODcxOA==", "user": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars0.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T01:04:31Z", "updated_at": "2018-08-16T01:20:19Z", "author_association": "CONTRIBUTOR", "body": "The VS2017 developer command prompt now defaults to 32-bit architecture (which I find to be an odd choice).  You can run `VsDevCmd.bat -arch=amd64` to switch to 64-bit mode (or set that up with a shortcut).  Presumably you are using a 64-bit installation of rust.  Or, if you really want to compile in 32-bit, the `stable-i686-pc-windows-msvc` rust toolchain worked for me.\r\n\r\nEDIT: Also, if you start a normal console without any of the visual studio environment variables, it should build fine."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413391220", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413391220", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413391220, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM5MTIyMA==", "user": {"login": "kc8apf", "id": 9454487, "node_id": "MDQ6VXNlcjk0NTQ0ODc=", "avatar_url": "https://avatars3.githubusercontent.com/u/9454487?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kc8apf", "html_url": "https://github.com/kc8apf", "followers_url": "https://api.github.com/users/kc8apf/followers", "following_url": "https://api.github.com/users/kc8apf/following{/other_user}", "gists_url": "https://api.github.com/users/kc8apf/gists{/gist_id}", "starred_url": "https://api.github.com/users/kc8apf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kc8apf/subscriptions", "organizations_url": "https://api.github.com/users/kc8apf/orgs", "repos_url": "https://api.github.com/users/kc8apf/repos", "events_url": "https://api.github.com/users/kc8apf/events{/privacy}", "received_events_url": "https://api.github.com/users/kc8apf/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T01:19:02Z", "updated_at": "2018-08-16T01:19:02Z", "author_association": "NONE", "body": "Thank you for pointing that out. I'm explicitly starting a x64 console and\nhave only the x64 Rust target installed. Even in x64 mode, the 32-bit\nlinker is used to link 64-bit code apparently.\n\nOn Wed, Aug 15, 2018, 6:04 PM ehuss <notifications@github.com> wrote:\n\n> The VS2017 developer command prompt now defaults to 32-bit architecture\n> (which I find to be an odd choice). You can run VsDevCmd.bat -arch=amd64\n> to switch to 64-bit mode (or set that up with a shortcut). Presumably you\n> are using a 64-bit installation of rust. Or, if you really want to compile\n> in 32-bit, the stable-i686-pc-windows-msvc rust toolchain worked for me.\n>\n> \u2014\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/rust-lang/cargo/issues/5898#issuecomment-413388718>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AJBDl-q7RelSEhPhe9AcpY741XCX1LrLks5uRMUhgaJpZM4V-_3D>\n> .\n>\n"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413394230", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413394230", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413394230, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM5NDIzMA==", "user": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars0.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T01:35:58Z", "updated_at": "2018-08-16T01:35:58Z", "author_association": "CONTRIBUTOR", "body": "> I'm explicitly starting a x64 console\r\n\r\nHow is that set up?  By default (AFAIK), VS2017 does not ship with that anymore.  It looks odd that it is trying to use a 32-bit linker.  Does it compile if you start a console without any of the vs env vars?"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413395923", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413395923", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413395923, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM5NTkyMw==", "user": {"login": "kc8apf", "id": 9454487, "node_id": "MDQ6VXNlcjk0NTQ0ODc=", "avatar_url": "https://avatars3.githubusercontent.com/u/9454487?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kc8apf", "html_url": "https://github.com/kc8apf", "followers_url": "https://api.github.com/users/kc8apf/followers", "following_url": "https://api.github.com/users/kc8apf/following{/other_user}", "gists_url": "https://api.github.com/users/kc8apf/gists{/gist_id}", "starred_url": "https://api.github.com/users/kc8apf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kc8apf/subscriptions", "organizations_url": "https://api.github.com/users/kc8apf/orgs", "repos_url": "https://api.github.com/users/kc8apf/repos", "events_url": "https://api.github.com/users/kc8apf/events{/privacy}", "received_events_url": "https://api.github.com/users/kc8apf/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T01:45:21Z", "updated_at": "2018-08-16T01:45:21Z", "author_association": "NONE", "body": "The shortcuts we're in my start menu after installing. If I start a plain\nconsole, the build can't find cmake.exe. keep in mind that the cmake build\nworks perfectly fine in the same console if I run the cmake invocations\nthat cargo does. It only fails when run under cargo.\n\nOn Wed, Aug 15, 2018, 6:36 PM ehuss <notifications@github.com> wrote:\n\n> I'm explicitly starting a x64 console\n>\n> How is that set up? By default (AFAIK), VS2017 does not ship with that\n> anymore. It looks odd that it is trying to use a 32-bit linker. Does it\n> compile if you start a console without any of the vs env vars?\n>\n> \u2014\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/rust-lang/cargo/issues/5898#issuecomment-413394230>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AJBDlxg7NC2-6FHIbslP6n9MHy2yFLreks5uRMyAgaJpZM4V-_3D>\n> .\n>\n"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413408882", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413408882", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413408882, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzQwODg4Mg==", "user": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars0.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T02:59:21Z", "updated_at": "2018-08-16T02:59:21Z", "author_association": "CONTRIBUTOR", "body": "I typically use cmake installed from https://cmake.org/ instead of the one bundled with visual studio (just add it to your PATH).  I typically never use the visual studio env setup, it's usually not required.  Otherwise, I'm not sure, your setup seems to be different from mine.  I'm no expert on visual studio, so I'm not really sure."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/413414295", "html_url": "https://github.com/rust-lang/cargo/issues/5898#issuecomment-413414295", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/5898", "id": 413414295, "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzQxNDI5NQ==", "user": {"login": "kc8apf", "id": 9454487, "node_id": "MDQ6VXNlcjk0NTQ0ODc=", "avatar_url": "https://avatars3.githubusercontent.com/u/9454487?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kc8apf", "html_url": "https://github.com/kc8apf", "followers_url": "https://api.github.com/users/kc8apf/followers", "following_url": "https://api.github.com/users/kc8apf/following{/other_user}", "gists_url": "https://api.github.com/users/kc8apf/gists{/gist_id}", "starred_url": "https://api.github.com/users/kc8apf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kc8apf/subscriptions", "organizations_url": "https://api.github.com/users/kc8apf/orgs", "repos_url": "https://api.github.com/users/kc8apf/repos", "events_url": "https://api.github.com/users/kc8apf/events{/privacy}", "received_events_url": "https://api.github.com/users/kc8apf/received_events", "type": "User", "site_admin": false}, "created_at": "2018-08-16T03:33:47Z", "updated_at": "2018-08-16T03:33:47Z", "author_association": "NONE", "body": "Installed CMake via chocolatey and added it to PATH.  Running 'cargo build' for libssh2-sys in a regular Command Prompt and PowerShell results in the same linker error.  Setting PreferredToolArchitecture=x64 still works."}]