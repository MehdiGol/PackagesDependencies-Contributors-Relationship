[{"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/427658120", "html_url": "https://github.com/rust-lang/cargo/issues/6153#issuecomment-427658120", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/6153", "id": 427658120, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzY1ODEyMA==", "user": {"login": "withoutboats", "id": 9063376, "node_id": "MDQ6VXNlcjkwNjMzNzY=", "avatar_url": "https://avatars2.githubusercontent.com/u/9063376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/withoutboats", "html_url": "https://github.com/withoutboats", "followers_url": "https://api.github.com/users/withoutboats/followers", "following_url": "https://api.github.com/users/withoutboats/following{/other_user}", "gists_url": "https://api.github.com/users/withoutboats/gists{/gist_id}", "starred_url": "https://api.github.com/users/withoutboats/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/withoutboats/subscriptions", "organizations_url": "https://api.github.com/users/withoutboats/orgs", "repos_url": "https://api.github.com/users/withoutboats/repos", "events_url": "https://api.github.com/users/withoutboats/events{/privacy}", "received_events_url": "https://api.github.com/users/withoutboats/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-07T14:35:18Z", "updated_at": "2018-10-07T14:37:01Z", "author_association": "CONTRIBUTOR", "body": "My initial inclination is against doing something like this, but I could be convinced.\r\n\r\nThere are a few barriers already against accidentally publishing:\r\n\r\n1. The `cargo publish` command has no other purpose, and none of our other major commands are similar, making users less likely to accidentally run `cargo publish` when they meant to run something else.\r\n2. The publication will fail if you aren't logged in, making it less likely for you to successfully publish something when you are new to Rust & haven't yet learned what `cargo publish` is for. That is, the first time you publish you have to actively try to by creating a crates.io account, so we avoid the problem of people running commands without understanding them.\r\n3. The crate created by `cargo new` will be rejected by crates.io because it lacks a license and description field. You have to have set both of those up before you can publish.\r\n4. `cargo publish` fails if your crate doesn't build or if your VCS repository is dirty.\r\n5. If you're publishing a subsequent version of a crate, `cargo publish` will fail if you haven't updated the version number to the new version.\r\n\r\nMy own experience of publishing is that I almost always run afoul of one of the existing checks when I go to publish - usually I haven't set a license or description field.\r\n\r\nOften the code you don't want to publish is a project you intend to publish someday (and you may have already published a previous version of it). Its perfectly possible to set the publish bit and then run `cargo publish` by mistake later. That is, this only prevents an accidental publish of a completely new crate, and only once all of the other roadblocks mentioned earlier have been hurdled by the user.\r\n\r\n---\r\n\r\nMore succinctly, the only interface that will prevent people from accidentally publishing is to disallow publishing entirely. I don't think accidental publishing happens often enough right now that there need to be more roadblocks than there already are."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/427659468", "html_url": "https://github.com/rust-lang/cargo/issues/6153#issuecomment-427659468", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/6153", "id": 427659468, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzY1OTQ2OA==", "user": {"login": "yonni12", "id": 11151181, "node_id": "MDQ6VXNlcjExMTUxMTgx", "avatar_url": "https://avatars1.githubusercontent.com/u/11151181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yonni12", "html_url": "https://github.com/yonni12", "followers_url": "https://api.github.com/users/yonni12/followers", "following_url": "https://api.github.com/users/yonni12/following{/other_user}", "gists_url": "https://api.github.com/users/yonni12/gists{/gist_id}", "starred_url": "https://api.github.com/users/yonni12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yonni12/subscriptions", "organizations_url": "https://api.github.com/users/yonni12/orgs", "repos_url": "https://api.github.com/users/yonni12/repos", "events_url": "https://api.github.com/users/yonni12/events{/privacy}", "received_events_url": "https://api.github.com/users/yonni12/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-07T14:55:05Z", "updated_at": "2018-10-07T19:19:08Z", "author_association": "NONE", "body": "I agree that accidentally publishing is probably a niche issue, but I don't see how yours are arguments _against_ this proposal, so much as they are arguments that in your experience it's _unnecessary_.\r\n\r\nOne way to think about it is this: if we're going to have a `publish` flag, then it should default to the \"safe\" state of `false` (you never lose anything -- except a couple of seconds -- by not publishing when you meant to). If the `publish` flag is so unnecessary, then it should be removed altogether. Right now, there is a flag whose only purpose is to save you from yourself that defaults to the \"unsafe\" option.\r\n\r\nAs for the other barriers, I think they should all remain, but none of them are as explicit as \"I don't want this published\". For example, you might choose to not set a license, or not log in, simply because you don't want to publish. But in a year's time, you're unlikely to remember that. The advantage of the `publish` flag is that the intentionality is explicit."}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/427896568", "html_url": "https://github.com/rust-lang/cargo/issues/6153#issuecomment-427896568", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/6153", "id": 427896568, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzg5NjU2OA==", "user": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars1.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-08T16:23:02Z", "updated_at": "2018-10-08T16:23:02Z", "author_association": "MEMBER", "body": "cc @rust-lang/cargo, others likely have thoughts on this as well!"}, {"url": "https://api.github.com/repos/rust-lang/cargo/issues/comments/427902074", "html_url": "https://github.com/rust-lang/cargo/issues/6153#issuecomment-427902074", "issue_url": "https://api.github.com/repos/rust-lang/cargo/issues/6153", "id": 427902074, "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzkwMjA3NA==", "user": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "created_at": "2018-10-08T16:41:12Z", "updated_at": "2018-10-08T16:41:12Z", "author_association": "MEMBER", "body": "My initial feeling is -0 (weakly opposed). I don't feel *strongly* about this, it just feels like a bit of an unnecessary stumbling block in a new project. I can absolutely understand the desire to make sure people don't publish accidentally, however."}]